## 一、项目背景与目标

### 1.1 背景

在电商平台运营中，用户画像和评论内容安全是两大核心问题：

- 用户画像：需要构建精准的用户标签体系，优化广告投放策略

- 评论安全：需要实时识别和处理敏感评论，维护平台健康环境


### 1.2 目标

整合用户画像构建与评论内容审核两大系统，形成从用户行为分析到内容安全监控的完整大数据解决方案。

## 二、整体架构设计

### 2.1 系统架构图

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   用户画像构建   │    │   评论生成      │    │  敏感评论检测   │
│                 │    │                 │    │                 │
│ · 基础特征提取  │    │ · AI评论生成    │    │ · 实时流处理    │
│ · 行为分析      │    │ · 敏感词注入    │    │ · 敏感词匹配    │
│ · 标签计算      │    │ · 本地模板      │    │ · 分级处理      │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         └───────────────────────┼───────────────────────┘
                                 │
                    ┌─────────────────┐
                    │   SQL Server    │
                    │   数据存储      │
                    └─────────────────┘
```

### 2.2 数据流转流程

1.1


## 三、用户画像构建系统（达摩盘基础特征）

### 3.1 基础特征体系

表格

复制

|特征类型|标签示例|数据来源|更新频率|
|:--|:--|:--|:--|
|人口属性|年龄、性别|用户资料、行为数据|每日|
|物理特征|身高、体重|订单备注、设备同步|实时/T+1|
|兴趣偏好|星座、品类偏好|浏览、购买行为|每日|

### 3.2 年龄标签计算逻辑

复制

```
总分 = Σ(维度得分 × 权重)
维度包括：
- 类目偏好得分（潮流服饰、家居用品等）
- 品牌偏好得分（ZARA、海澜之家等）
- 价格敏感度
- 时间行为（凌晨、早晨、下午等）
- 搜索词分析（时尚、性价比、健康等）
- 社交互动行为（直播、评论、分享等）
- 设备信息（iOS、Android、高端设备等）
```

### 3.3 性别标签判断规则

- **女性用户**：女性得分 > 男性得分 + 10%

- **男性用户**：男性得分 > 女性得分 + 10%

- **家庭用户**：家庭品类占比≥30% 且 男女得分差≤10%


## 四、评论生成系统

### 4.1 生成策略

- **好评率**：70%（可配置）

- **敏感词注入率**：15%（可配置）

- **生成方式**：

    - 优先使用AI生成（调用硅基流动API）

    - API不可用则降级到本地模板库


### 4.2 商品名称处理

复制

```
原始名称："lululemon丨Daily Stride 女士中筒袜 3双装 LW9EL0S 白/杂色灰/黑 S"
处理结果：
- 品牌路径："lululemon丨Daily Stride"
- 品牌系列："Daily Stride"
- 商品名称："女士中筒袜 3双装 LW9EL0S 白/杂色灰/黑 S"
```

### 4.3 评论示例

表格

复制

|类型|示例|
|:--|:--|
|正常好评|"这款女士中筒袜真的很不错，穿着舒适，质量满意！"|
|正常差评|"袜子尺码偏小，穿着有点紧，建议买大一号。"|
|敏感评论|"这袜子质量真【垃圾】，【骗钱】的商家，【坑爹】！"|

## 五、敏感评论实时检测系统

### 5.1 检测流程

`CDC数据 → 评论解析 → 敏感词匹配 → 分级判断 → 结果输出`

### 5.2 敏感词分级

表格

复制

|级别|描述|处理措施|示例关键词|
|:--|:--|:--|:--|
|P0|政治、色情、反动、毒品|黑名单365天|"国共主权"、"独裁政权"、"毒品"|
|P1|脏话、攻击性语言|黑名单60天|"垃圾"、"骗钱"、"坑爹"|
|P2|一般敏感词|仅标记|"差劲"、"烂货"、"废品"|

### 5.3 实时统计

复制

```
📊 实时统计:
   已处理记录: 1200 条
   敏感评论: 85 条 (7.1%)
   P0级别: 5 条
   P1级别: 30 条
   P2级别: 50 条
```

## 六、数据表设计

### 6.1 评论表结构

sql

复制

```sql
CREATE TABLE product_comments (
    id INT IDENTITY(1,1) PRIMARY KEY,
    order_id NVARCHAR(64),
    user_id NVARCHAR(255),
    product_id NVARCHAR(64),
    brand_path NVARCHAR(255),        -- 品牌路径
    brand_series NVARCHAR(255),      -- 品牌系列
    product_name NVARCHAR(255),      -- 商品名称
    review_text NVARCHAR(MAX),       -- 评论内容
    ds NVARCHAR(20),                 -- 日期分区
    ts NVARCHAR(20),                 -- 时间戳
    insert_time DATETIME,            -- 插入时间
    created_time DATETIME DEFAULT GETDATE()
)
```

实时写入 hbase 中去
### 6.2 用户画像表结构（示例）

sql

复制

```sql
CREATE TABLE user_profile (
    user_id NVARCHAR(255) PRIMARY KEY,
    age_label NVARCHAR(20),          -- 年龄标签
    gender_label NVARCHAR(20),       -- 性别标签
    height_cm INT,                   -- 身高
    weight_kg DECIMAL(5,1),          -- 体重
    constellation NVARCHAR(10),      -- 星座
    update_time DATETIME             -- 更新时间
)
```

## 七、系统集成与运行

### 7.1 运行顺序

1. **初始化数据库**：创建表结构

2. **生成评论数据**：运行评论生成系统

3. **启动检测作业**：提交Flink作业进行实时检测


### 7.2 关键配置

Python

复制

```python
# 评论生成配置
GOOD_RATE = 0.7          # 好评率
SENSITIVE_RATE = 0.15    # 敏感词注入率
BATCH_SIZE = 20          # 批量处理大小

# Flink配置
env.setParallelism(1)    # 并行度
```

### 7.3 部署建议

- **开发环境**：本地Flink集群 + SQL Server

- **生产环境**：Flink on YARN/K8s + 高可用SQL Server

- **监控**：Flink Web UI + 自定义指标上报


## 八、业务价值与应用场景

### 8.1 业务价值

1. **提升广告ROI**：精准用户画像提高广告投放转化率

2. **降低运营风险**：实时敏感评论检测维护平台形象

3. **数据驱动决策**：完整数据链路支持业务分析


### 8.2 应用场景

- **广告投放**：基于用户标签进行精准定向

- **内容审核**：实时过滤有害评论

- **用户运营**：识别高价值用户与风险用户

- **商品分析**：结合评论情感分析优化商品策略


## 九、后续优化方向

### 9.1 算法优化

- 引入机器学习模型进行敏感评论识别

- 使用NLP技术进行评论情感分析


### 9.2 系统扩展

- 支持多语言评论检测

- 增加图片/视频内容审核

- 构建用户评论信用体系


### 9.3 数据应用

- 用户画像与推荐系统结合

- 评论数据与商品搜索结合

- 构建实时数据大屏展示